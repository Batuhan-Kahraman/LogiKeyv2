﻿@using BusinessLayer.Concrate
@using EntityLayer.Concrate
@model EntityLayer.Concrate.YurtDisiTasima

@{
    ViewData["Title"] = "Taşıma Ekle";
}
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
<script>
    var items = 0;
    var satirVeUrunSayisi = [];
    var evrakDizisi = [];
    function YurtDisiEvraklarListe(sira, selected = "") {
        $.ajax({
            url: '../../Ajax/YurtDisiEvraklarListe', // Verileri sağlayan API'nin endpoint'i
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                $('#Evraklar' + sira + 'ID').empty();
                $('#Evraklar' + sira + 'ID').append($('<option>', {
                    value: 0, // Verinin değer özelliği
                    text: "Seçiniz", // Verinin görünen metni
                        disabled: true, // Option elementini devre dışı bırak
                    selected: true  // Option elementini seçili yap
                }));
                // Verileri selectbox'a ekle
                $.each(data, function (index, item) {
                    console.log(item);
                    if (selected == item.id) {
                        $('#Evraklar' + sira + 'ID').append($('<option>', {
                            value: item.id, // Verinin değer özelliği
                            text: item.adi, // Verinin görünen metni
                            selected: true
                        }));
                    }
                    else {

                        $('#Evraklar' + sira + 'ID').append($('<option>', {
                            value: item.id, // Verinin değer özelliği
                            text: item.adi // Verinin görünen metni
                        }));
                    }
                });
            },
            error: function (error) {
                console.log('Hata oluştu:', error);
            }
        });

    }

    function YurtDisiTasimaTipiListe(id) {
        $.ajax({
            url: '../../Ajax/YurtDisiTasimaTipiListe', // Verileri sağlayan API'nin endpoint'i
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                $('#' + id).empty();
                $('#' + id).append($('<option>', {
                    value: "", // Verinin değer özelliği
                    text: "Seçiniz", // Verinin görünen metni
                    disabled: true,
                    selected: true,
                }));
                // Verileri selectbox'a ekle
                $.each(data, function (index, item) {
                    console.log(item);
                    $('#' + id).append($('<option>', {
                        value: item.id, // Verinin değer özelliği
                        text: item.adi // Verinin görünen metni
                    }));
                });
            },
            error: function (error) {
                console.log('Hata oluştu:', error);
            }
        });
    }

</script>

<style>

    td, select {
        width: 250px !important;
    }
</style>

<div class="col-lg-30 col-xxl-12">
    @if (TempData["Msg"] != null)
    {
        <div class="d-flex">
            <div class="toast show align-items-center text-white dark__text-gray-1100 border-0 m-3" role="alert" data-bs-autohide="false" aria-live="assertive" aria-atomic="true" style="background:@TempData["Bgcolor"]">
                <div class="d-flex">
                    <div>
                        @TempData["Msg"]
                    </div>

                </div>
            </div>
        </div>

    }

    <div class="border table-responsive scrollbar p-2">
        <form method="post" action="TasimaDuzenle" onsubmit="return validateForm()">
            @{
                var yurtDisiTasima = Model;

            }
            <input type="hidden" asp-for="ID" />
            <input type="hidden" name="KayitSayisi" id="KayitSayisi" value="1" />
            <table class="table table-borderless">
                <tr>
                    <td rowspan="6" colspan="1" style="width:50px !important; margin-right:10px;background:#02224b" class="vertical-text text-center" style="background:#a9a4a4;">
                        <h5 style="color:#fff !important;">Araç</h5>
                    </td>
                    <td>Araç Tür</td>
                    <td class="d-flex">

                        <a asp-controller="YurtDisiAracTur" asp-action="Index" target="_blank" class="me-2">
                            <span class="text-body fs-5" data-feather="plus"></span>
                        </a>
                        <a onclick="YurtDisiAracTurListe()" class="me-2" style="cursor:pointer;">
                            <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                        </a>
                        <select class="form-control" name="AracTurID" id="Arac_TurID" onchange="TureGoreAracListe()">
                            <option value="0">Seçiniz</option>
                           
                        </select>


                    </td>
                    <td>Araç</td>
                    <td class="d-flex">
                        <a asp-controller="Arac" asp-action="Index" as-route-ModulID="10" target="_blank" class="me-2">
                            <span class="text-body fs-5" data-feather="plus"></span>
                        </a>
                        <a onclick="TureGoreAracListe()" class="me-2" style="cursor:pointer;">
                            <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                        </a>
                        <select class="form-control" name="AracID" id="Arac_ID">
                            <option value="0">Seçiniz</option>

                        </select>
                    </td>
                    <td id="tdDorse" style="">Dorse Plakası</td>
                    <td id="tdDorseSec" style="" >
                        <a asp-controller="Arac" asp-action="Index" as-route-ModulID="10" target="_blank" class="me-2">
                            <span class="text-body fs-5" data-feather="plus"></span>
                        </a>
                        <a onclick="DorseListe()" class="me-2" style="cursor:pointer;">
                            <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                        </a>
                        <select asp-for="DorsePlakaID" class=" form-control" id="DorsePlakaID">
                            <option value="0">Seçiniz</option>
                        </select>
                    </td>


                </tr>
                <tr>
                    <td>Sürücü 1 Ekle</td>
                    <td class="d-flex">
                        <a asp-controller="Surucu" asp-action="Index" target="_blank" class="me-2">
                            <span class="text-body fs-5" data-feather="plus"></span>
                        </a>
                        <a onclick="SurucuListe('Kullanici1ID')" class="me-2" style="cursor:pointer;">
                            <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                        </a>
                        <select class="form-control" asp-for="Kullanici1ID" id="Kullanici1ID">
                            <option value="0">Seçiniz</option>
                        </select>
                    </td>
                    <td>Sürücü 2 Ekle</td>
                    <td class="d-flex">
                        <a asp-controller="Surucu" asp-action="Index" target="_blank" class="me-2">
                            <span class="text-body fs-5" data-feather="plus"></span>
                        </a>
                        <a onclick="SurucuListe('Kullanici2ID')" class="me-2" style="cursor:pointer;">
                            <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                        </a>
                        <select class="form-control" asp-for="Kullanici2ID" id="Kullanici2ID">
                            <option value="0">Seçiniz</option>

                        </select>
                    </td>
                    <td>Sürücü 3 Ekle</td>
                    <td class="d-flex">
                        <a asp-controller="Surucu" asp-action="Index" target="_blank" class="me-2">
                            <span class="text-body fs-5" data-feather="plus"></span>
                        </a>
                        <a onclick="SurucuListe('Kullanici3ID')" class="me-2" style="cursor:pointer;">
                            <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                        </a>
                        <select class="form-control" asp-for="Kullanici3ID" id="Kullanici3ID">
                            <option value="0">Seçiniz</option>

                        </select>
                    </td>

                </tr>
                <!--
                <tr>

                    <td>Toplam Yüklenen Miktar</td>
                    <td colspan="5"><input type="text" class="form-control bg-light w-100" asp-for="ToplamYuklenenMiktar" value="@yurtDisiTasima.ToplamYuklenenMiktar" id="ToplamYuklenenMiktar" readonly /></td>


                </tr>
                -->

            </table>


            <table class="table table-borderless" id="hiddenFields4" style="width:100%;">
                <tr>

                    <td colspan="6">
                        <a onclick="EvrakSatiriEkle()"> Evrak Ekle</a>
                    </td>
                </tr>
                @{
                    int sira = 1;
                    foreach (var item in ViewBag.YurtDisiTasimaEvraklar)
                    {
                        string id = "Evraklar" + sira + "ID";
                        string trid = "TREvraklar" + sira + "ID";

                        <tr id="@trid">
                            <td>
                                <a onclick="EvrakSatirSil('@trid')">
                                    <span class="text-body fs-5" data-feather="x" style="color:red;"></span>
                                </a>
                            </td>
                            <td>Evrak</td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <a asp-controller="YurtDisiEvraklar" asp-action="Index" target="_blank" class="me-2">
                                        <span class="text-body fs-5" data-feather="plus"></span>
                                    </a>
                                    <a onclick="YurtDisiEvraklarListe(@sira)" class="me-2" style="cursor:pointer;">
                                        <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                                    </a>
                                    <select class="form-control" name="Evraklar[]" id="@id" style="width:100%">
                                        <option value="" disabled selected>Seçiniz</option>

                                    </select>
                                </div>
                            </td>
                            <td>Veriliş Tarihi</td>
                            <td>
                                <input type="date" class="form-control" name="EvraklarVerilisTarihi[]" value="@item.EvraklarVerilisTarihi.ToString("yyyy-MM-dd")" />

                            </td>
                            <td>Geçerlilik Tarihi</td>
                            <td>
                                <input type="date" class="form-control" name="EvraklarGecerlilikTarihi[]" value="@item.EvraklarGecerlilikTarihi.ToString("yyyy-MM-dd")" />
                            </td>
                        </tr>

                        <script>

                            evrakDizisi.push({ sira: @sira, deger: @item.EvrakID });
                            console.log(evrakDizisi);
                            YurtDisiEvraklarListe(@sira,@item.EvrakID);
                        </script>

                        sira++;
                    }
                }


            </table>


            <div class="accordion" id="accordionExample">
                @{
                    var sayac = 0;
                    List<YurtDisiTasimaDetay> tasimaDetay = Helper.YurtDisiTasimaDetayList(yurtDisiTasima.ID);

                    foreach (var detay in tasimaDetay)
                    {
                        sayac++;

                        <script>
                            items++;

                            document.getElementById("KayitSayisi").value = items;
                            satirVeUrunSayisi.push({ satir: items, urun: 0 });</script>

                        <input type="hidden" name="detayID@(sayac)[]" value="@detay.ID" />
                        <div class="accordion-item border-top">
                            <h2 class="accordion-header" id="heading@(sayac)">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse@(sayac)" aria-expanded="false" aria-controls="collapse@(sayac)">
                                    @sayac .KAYIT
                                </button>
                            </h2>
                            <div class="accordion-collapse collapse" id="collapse@(sayac)" aria-labelledby="heading@(sayac)" data-bs-parent="#accordionExample" style="">
                                <div class="accordion-body pt-0">
                                    <table class="table table-borderless" id="kayit@(sayac)">

                                        <!-- Gönderici -->
                                        <tr>
                                            <td rowspan="3" colspan="1" style="width:50px !important; margin-right:10px;background:#0a4ea5" class="vertical-text text-center">
                                                <h5 style="color:#fff !important;"> Gönderici Firma</h5>
                                            </td>
                                            <td>Mal Sahibi</td>
                                            <td class="d-flex">
                                                <a asp-controller="Cari" asp-action="Ekle" target="_blank" class="me-2">
                                                    <span class="text-body fs-5" data-feather="plus"></span>
                                                </a>
                                                <a onclick="GondericiCariListe('GondericiCari_ID@(sayac)')" class="me-2" style="cursor:pointer;">
                                                    <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                                                </a>
                                                <select name="GondericiCari_ID@(sayac)[]" class=" form-control" id="GondericiCari_ID@(sayac)">
                                                    <option value="0">Seçiniz</option>
                                                    @foreach (var item in ViewBag.GondericiListesi)
                                                    {
                                                        if (detay.GondericiID == item.Cari_ID)
                                                        {
                                                            <option value="@item.Cari_ID" selected>@item.Cari_Unvan</option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@item.Cari_ID">@item.Cari_Unvan</option>
                                                        }
                                                    }

                                                </select>
                                            </td>
                                            <td>Taşıma Türü</td>
                                            <td class="d-flex">
                                                <a asp-controller="YurtDisiTasimaTipi" asp-action="Index" target="_blank" class="me-2">
                                                    <span class="text-body fs-5" data-feather="plus"></span>
                                                </a>
                                                <a onclick="YurtDisiTasimaTipiListe('YurtDisiTasimaTipi_ID1')" class="me-2" style="cursor:pointer;">
                                                    <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                                                </a>
                                                <select name="YurtDisiTasimaTipi_ID@(sayac)[]" class=" form-control" id="YurtDisiTasimaTipi_ID@(sayac)">
                                                    <option value="0">Seçiniz</option>


                                                </select>
                                                <script>

                                                    YurtDisiTasimaTipiListe('YurtDisiTasimaTipi_ID@(sayac)');
</script>
                                            </td>
                                            <td>Gümrükleme Tarihi</td>
                                            <td><input type="date" class="form-control" name="GumruklemeTarihi@(sayac)[]" id="GumruklemeTarihi@(sayac)" value="@detay.GumruklemeTarihi.ToString("yyyy-MM-dd")" /></td>
                                        </tr>
                                        
                                        <tr>
                                            <td>Mal Yükleme Ülke</td>
                                            <td><input type="text" class="form-control" name="GondericiYuklemeUlke@(sayac)[]" id="GondericiYuklemeUlke@(sayac)" value="@detay.GondericiYuklemeUlke" /></td>
                                            <td>Mal Yükleme İl</td>

                                            <td><input type="text" class="form-control" name="GondericiYuklemeIl@(sayac)[]" id="GondericiYuklemeIl@(sayac)" value="@detay.GondericiYuklemeIl" /></td>
                                            <td>Mal Yükleme İlçe</td>

                                            <td><input type="text" class="form-control" name="GondericiYuklemeIlce@(sayac)[]" id="GondericiYuklemeIlce@(sayac)" value="@detay.GondericiYuklemeIlce" /></td>
                                        </tr>

                                        <tr>
                                            <td>Açık Adres</td>
                                            <td colspan="5"><textarea class="form-control" name="GondericiYuklemeAcikAdres1[]" id="GondericiYuklemeAcikAdres1"></textarea></td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #ddd; margin-bottom:2%;">

                                            <td>Mal Yükleme Tarih Saat</td>
                                            <td colspan="5">
                                                <input type="date" class="form-control" name="GondericiFirmaTarihSaat@(sayac)[]" id="GondericiFirmaTarihSaat@(sayac)" value="@detay.GondericiYuklemeTarihSaat.ToString("yyyy-MM-dd")" />


                                            </td>

                                        </tr>

                                        <!-- Alıcı -->
                                        <tr>
                                            <td rowspan="3" colspan="1" style="width:50px !important; margin-right:10px;background:#0e65d5" class="vertical-text text-center">
                                                <h5 style="color:#fff !important;"> Alıcı Firma</h5>
                                            </td>
                                            <td>Alıcı Firma</td>
                                            <td class="d-flex">
                                                <a asp-controller="Cari" asp-action="Ekle" target="_blank" class="me-2">
                                                    <span class="text-body fs-5" data-feather="plus"></span>
                                                </a>
                                                <a onclick="AliciCariListe('AliciCari_ID@(sayac)')" class="me-2" style="cursor:pointer;">
                                                    <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                                                </a>

                                                <select name="AliciCari_ID@(sayac)[]" class=" form-control" id="AliciCari_ID@(sayac)">
                                                    <option value="0">Seçiniz</option>


                                                    @foreach (var item in ViewBag.AliciListesi)
                                                    {

                                                        if (detay.AliciID == item.Cari_ID)
                                                        {
                                                            <option value="@item.Cari_ID" selected>@item.Cari_Unvan</option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@item.Cari_ID">@item.Cari_Unvan</option>
                                                        }
                                                    }

                                                </select>
                                            </td>

                                        </tr>
                                        <tr>

                                            <td>İndirilen Ülke</td>
                                            <td><input type="text" class="form-control" name="AliciIndirilenUlke@(sayac)[]" id="AliciIndirilenUlke@(sayac)" value="@detay.AliciIndirilenUlke" /></td>
                                            <td>İndirilen İl</td>

                                            <td><input type="text" class="form-control" name="AliciIndirilenIl@(sayac)[]" id="AliciIndirilenIl@(sayac)" value="@detay.AliciIndirilenIl" /></td>
                                            <td>İndirilen İlçe</td>

                                            <td><input type="text" class="form-control" name="AliciIndirilenIlce@(sayac)[]" id="AliciIndirilenIlce@(sayac)" value="@detay.AliciIndirilenIlce" /></td>

                                        </tr>
                                        <tr>
                                            <td>Açık Adres</td>
                                            <td colspan="5"><textarea class="form-control" name="AliciIndirilenAcikAdres1[]" id="AliciIndirilenAcikAdres1"></textarea></td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #ddd; margin-bottom:2%;">

                                            <td>Alıcı Tarih Saat</td>
                                            <td colspan="5"><input type="date" class="form-control" name="AliciFirmaTarihSaat@(sayac)[]" id="AliciFirmaTarihSaat@(sayac)" value="@detay.AliciIndirilenTarihSaat.ToString("yyyy-MM-dd")" /></td>

                                        </tr>

                                        @{
                                            List<YurtDisiTasimaDetayUrun> tasimaDetayUrun = Helper.YurtDisiTasimaDetayUrunList(yurtDisiTasima.ID, detay.ID);
                                            var sayacUrun = 1;
                                            foreach (var urun in tasimaDetayUrun)
                                            {
                                                <!-- Ürün -->
                                                <tr id="templateRow@(sayac)_@(sayacUrun)">

                                                    <td rowspan="2" colspan="1" style="width:50px !important; margin-right:10px;background:#06326b" class="vertical-text text-center">

                                                        <input type="hidden" name="detayUrunID@(sayac)[]" value="@urun.ID" />
                                                        <h5 style="color:#fff !important;"> Ürün</h5>
                                                    </td>
                                                    <td>Ürün Seç</td>
                                                    <td class="d-flex">
                                                        <a asp-controller="TasinacakUrun" asp-action="Index" target="_blank" class="me-2">
                                                            <span class="text-body fs-5" data-feather="plus"></span>
                                                        </a>
                                                        <a onclick="TasinacakUrunListe('TasinacakUrun_ID@(sayac)_@(sayacUrun)')" class="me-2" style="cursor:pointer;">
                                                            <span class="text-body fs-5" data-feather="refresh-ccw"></span>
                                                        </a>
                                                        <select name="TasinacakUrun_ID@(sayac)[]" class=" form-control" id="TasinacakUrun_ID@(sayac)_@(sayacUrun)" >
                                                            <option value="0">Seçiniz</option>

                                                            @foreach (var item in ViewBag.TasinacakUrun)
                                                            {
                                                                if (urun.UrunID == item.ID)
                                                                {
                                                                    <option value="@item.ID" selected>@item.Adi</option>

                                                                }
                                                                else
                                                                {
                                                                    <option value="@item.ID">@item.Adi</option>
                                                                }
                                                            }

                                                        </select>
                                                    </td>

                                                 

                                                    <td>Yükleme Miktarı</td>
                                                    <td><input type="number" class="form-control" name="YuklemeMiktari@(sayac)[]" id="YuklemeMiktari@(sayac)_@(sayacUrun)" value="@urun.YuklemeMiktari" onblur="toplamYuk()" /></td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid #ddd; margin-bottom:2%;" id="templateRow@(sayac)_2">
                                                    <td>Ödeme Yapan Cari</td>
                                                    <td>
                                                        <select name="Cari_Odeme_Yapan@(sayac)[]" class=" form-control" id="Cari_Odeme_Yapan_@(sayac)_@(sayacUrun)" onchange="OdemeYapan(this)">
                                                            <option value="0">Seçiniz</option>

                                                            @foreach (var item in ViewBag.CariOdemeYapan)
                                                            {

                                                                <option value="@item.OdemeYapan_ID" selected="@(urun.OdemeYapanCariGrup == item.OdemeYapan_ID)">@item.OdemeYapan_Adi</option>
                                                            }

                                                            <!-- seçilene göre ödeme yapan carinin idsi alınıcak -->
                                                        </select>
                                                        <input type="hidden" name="Cari_Odeme_YapanID@(sayac)[]" class=" form-control" id="Cari_Odeme_Yapan_ID_@(sayac)_@(sayacUrun)" value="@urun.OdemeYapanCariID">
                                                    </td>
                                                    <td>Ücretlendirme</td>
                                                    <td>
                                                        <select name="Ucretlendirme_ID@(sayac)[]" class=" form-control" id="Ucretlendirme_ID@(sayac)_@(sayacUrun)" onchange="fiyatHesapla(@(sayac))">
                                                            <option value="0">Seçiniz</option>
                                                            @foreach (var item in ViewBag.Ucretlendirme)
                                                            {
                                                                <option value="@item.Ucretlendirme_ID" selected="@(urun.Ucretlendirme == item.Ucretlendirme_ID)">@item.Ucretlendirme_Adi</option>
                                                            }


                                                        </select>
                                                    </td>
                                                    <td>Birim veya Sefer Fiyatı</td>
                                                    <td><input type="number" class="form-control" name="Birim_SeferFiyat@(sayac)[]" id="Birim_SeferFiyat@(sayac)_@(sayacUrun)" onchange="fiyatHesapla(@(sayac))" value="@urun.BirimSeferFiyati" /></td>

                                                </tr>
                                                sayacUrun++;
                                                <script>
                                                    var bulunanElemanIndex = satirVeUrunSayisi.findIndex(function (eleman) {
                                                        return eleman.satir === items;
                                                    });

                                                    var urunsayisi = satirVeUrunSayisi[bulunanElemanIndex].urun;

                                                    // Urun değerini artır
                                                    urunsayisi += 1;

                                                    // Urun değerini güncelle
                                                    satirVeUrunSayisi[bulunanElemanIndex].urun = urunsayisi;
                                                </script>
                                            }
                                        }

                                        <tr id="urunEkleTR1">
                                            <td colspan="6"><a class="btn btn-info col-3" onclick="urunEkle(@(sayac))">Ürün Ekle</a></td>
                                        </tr>
                                    </table>

                                    <table class="table table-borderless">
                                        <!-- Nakliye hesaplama -->
                                        <tr>
                                            <td colspan="1" rowspan="2" style="width:50px !important; margin-right:10px;background:#589cf3" class="vertical-text text-center">
                                                <h5 style="color:#fff !important;"> Nakliye Bedeli</h5>
                                            </td>
                                            <td>Tutar(KDV Hariç)</td>
                                            <td>
                                                <input type="number" class="form-control" name="NakliyeBedelTutar_KDVsiz@(sayac)[]" id="NakliyeBedelTutar_KDVsiz@(sayac)" value="@detay.NakliyeTutarKDVHaric" />
                                            </td>

                                            <td>Kdv</td>
                                            <td>
                                                <input type="number" class="form-control" name="NakliyeBedelTutar_KDV@(sayac)[]" id="NakliyeBedelTutar_KDV@(sayac)" value="@detay.NakliyeKDV" />
                                            </td>
                                            <td>Toplam Tutar(KDV Dahil)</td>
                                            <td><input type="text" class="form-control" name="NakliyeBedeliToplam_KDVli@(sayac)[]" id="NakliyeBedeliToplam_KDVli@(sayac)" value="@detay.NakliyeToplam" /></td>

                                        </tr>
                                        <tr>
                                            <td>Fiyat</td>
                                            <td colspan="5"><input type="text" class="form-control" name="Fiyat@(sayac)[]" id="Fiyat@(sayac)" value="@detay.NakliyeFiyat" readonly /></td>
                                        </tr>
                                    </table>

                                </div>
                            </div>
                        </div>
                    }
                }


            </div>
            <center class="mt-4">

                <a class="btn btn-info col-3" onclick="kaydetEkle()">Kaydet Ve Ekle</a>

                <input type="submit" class="btn btn-success col-3" value="Taşımayı Kaydet" />
            </center>
            <script>
                console.log("bbb");
            </script>


        </form>
    </div>


</div>

@section Scripts {


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <script>


        $(document).ready(function () {
            $('#uyariModal').modal('show');


        });
   
        function IlDegistir(IlKodu, sira) {

            $.ajax({
                url: '../../Ajax/IlceListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                data: { IlKodu: IlKodu },
                dataType: 'json',
                success: function (data) {
                    $('#MalYuklemeAdres_ILCE_ID' + sira).empty();
                    $('#MalYuklemeAdres_ILCE_ID' + sira).append($('<option>', {
                        value: 0, // Verinin değer özelliği
                        text: "Seçiniz" // Verinin görünen metni
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#MalYuklemeAdres_ILCE_ID' + sira).append($('<option>', {
                            value: item.ilcE_KODU, // Verinin değer özelliği
                            text: item.ilce // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }

        function IndirilenIlDegistir(IlKodu, sira) {

            $.ajax({
                url: '../../Ajax/IlceListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                data: { IlKodu: IlKodu },
                dataType: 'json',
                success: function (data) {
                    $('#IndirilenAdres_ILCE_ID' + sira).empty();
                    $('#IndirilenAdres_ILCE_ID' + sira).append($('<option>', {
                        value: 0, // Verinin değer özelliği
                        text: "Seçiniz" // Verinin görünen metni
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#IndirilenAdres_ILCE_ID' + sira).append($('<option>', {
                            value: item.ilcE_KODU, // Verinin değer özelliği
                            text: item.ilce // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }
        function fiyatHesapla(sira) {
            debugger;
            var fiyat = 0;
            console.log(satirVeUrunSayisi);
            var eleman = satirVeUrunSayisi.find(function (eleman) {
                return eleman.satir === sira;
            });
            var urunsayisi = eleman.urun;
            for (var k = 1; k <= urunsayisi; k++) {
                var Birim_SeferFiyat = document.getElementById("Birim_SeferFiyat" + sira + "_" + k).value;
                var Ucretlendirme_ID = document.getElementById("Ucretlendirme_ID" + sira + "_" + k).value;
                var YuklemeMiktari = document.getElementById("YuklemeMiktari" + sira + "_" + k).value;
                if (Ucretlendirme_ID == 2) {
                    fiyat += Birim_SeferFiyat * YuklemeMiktari;
                }
                else {
                    fiyat += Birim_SeferFiyat * 1;
                }
            }

            document.getElementById("Fiyat" + sira).value = fiyat;
        }

        function OdemeYapan(input) {
            debugger;
            var selectID = input.id;
            var deger = input.value;
            var parts = selectID.split('_');
            var sira = parts[parts.length - 2];
            var urun = parts[parts.length - 1];
            if (deger == 2)
                document.getElementById("Cari_Odeme_Yapan_ID_" + sira + "_" + urun).value = document.getElementById("GondericiCari_ID" + sira).value;
            else if (deger == 1)
                document.getElementById("Cari_Odeme_Yapan_ID_" + sira + "_" + urun).value = document.getElementById("AliciCari_ID" + sira).value;
            else
                alert("Lütfen Ödeme Yapacak Cariyi Seçiniz");

        }

        function validateForm() {
            debugger;
            var Arac_ID = document.getElementById("Arac_ID").value;
            var parca = Arac_ID.split("|");
            var aracID = parca[0];
            var turID = parca[1];
            if (turID == 1) {
                var selectElement = document.getElementById("DorsePlakaID");
                if (selectElement.value == "0") {
                    alert("Lütfen dorse değer seçin.");
                    return false;
                }
            }
            return true;
        }


        function toplamYuk() {
            /*
            var toplamYuklenenMiktar = 0;

            for (var i = 1; i <= items; i++) {
                var eleman = satirVeUrunSayisi.find(function (eleman) {
                    return eleman.satir === i;
                });
                var urunsayisi = eleman.urun;
                for (var k = 1; k <= urunsayisi; k++) {
                    var YuklemeMiktari = parseFloat(document.getElementById("YuklemeMiktari" + i + "_" + k).value);

                    if (YuklemeMiktari == "")
                        YuklemeMiktari = 0;
                    else {
                        toplamYuklenenMiktar += YuklemeMiktari;
                    }
                }
                document.getElementById("ToplamYuklenenMiktar").value = toplamYuklenenMiktar;

            }
            */
        }
       
        function YurtDisiAracTurListe() {
            //araç türleri listele
            $.ajax({
                url: '../../Ajax/YurtDisiAracTurAdliListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                dataType: 'json',
                success: function (data) {
                    $('#Arac_TurID').empty();
                    $('#Arac_TurID').append($('<option>', {
                        value: "", // Verinin değer özelliği
                        text: "Seçiniz", // Verinin görünen metni
                        disabled: true,
                        selected: true,
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);

                        $('#Arac_TurID').append($('<option>', {
                            value: item.aracTur.id, // Verinin değer özelliği
                            text: item.aracTur.adi // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }
        YurtDisiAracTurListe();


        function TureGoreAracListe() {
            //araç türleri listele
            var AracTurID = document.getElementById("Arac_TurID").value;
            $.ajax({
                url: '../../Ajax/TureAitPlakaListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                data: { AracTurID: AracTurID },
                dataType: 'json',
                success: function (data) {
                    $('#Arac_ID').empty();
                    $('#Arac_ID').append($('<option>', {
                        value: "", // Verinin değer özelliği
                        text: "Seçiniz", // Verinin görünen metni
                        disabled: true,
                        selected: true,
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#Arac_ID').append($('<option>', {
                            value: item.id, // Verinin değer özelliği
                            text: item.plaka // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
            if (AracTurID == 1) {
                document.getElementById("tdDorse").style.display = "";
                document.getElementById("tdDorseSec").style.display = "";
                document.getElementById("tdDorseSec").classList.add("d-flex");
                DorseListe();
            }
            else {
                document.getElementById("tdDorse").style.display = "none";
                document.getElementById("tdDorseSec").style.display = "none";
                document.getElementById("tdDorseSec").classList.remove("d-flex");
                //GozSayisiBul(aracID);
            }

        }

        function DorseListe() {

            $.ajax({
                url: '../../Ajax/DorseListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                dataType: 'json',
                success: function (data) {
                    $('#DorsePlakaID').empty();
                    $('#DorsePlakaID').append($('<option>', {
                        value: 0, // Verinin değer özelliği
                        text: "Seçiniz" // Verinin görünen metni
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#DorsePlakaID').append($('<option>', {
                            value: item.id, // Verinin değer özelliği
                            text: item.plaka // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }

        function SurucuListe(id) {
            $.ajax({
                url: '../../Ajax/SurucuListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                dataType: 'json',
                success: function (data) {
                    $('#' + id).empty();
                    $('#' + id).append($('<option>', {
                        value: 0, // Verinin değer özelliği
                        text: "Seçiniz" // Verinin görünen metni
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#' + id).append($('<option>', {
                            value: item.kullanici_ID, // Verinin değer özelliği
                            text: item.kullanici_Isim + " " + item.kullanici_Soyisim // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }

        SurucuListe('Kullanici1ID');
        SurucuListe('Kullanici2ID');
        SurucuListe('Kullanici3ID');


        function GondericiCariListe(id) {
            $.ajax({
                url: '../../Ajax/CariGrubaGoreListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                data: { GrupID: 6 },//gonderici grubu=6
                dataType: 'json',
                success: function (data) {
                    $('#' + id).empty();
                    $('#' + id).append($('<option>', {
                        value: "", // Verinin değer özelliği
                        text: "Seçiniz", // Verinin görünen metni
                        disabled: true,
                        selected: true,
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#' + id).append($('<option>', {
                            value: item.cari_ID, // Verinin değer özelliği
                            text: item.cari_Unvan // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }
        GondericiCariListe('GondericiCari_ID1');


        function AliciCariListe(id) {
            $.ajax({
                url: '../../Ajax/CariGrubaGoreListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                data: { GrupID: 8 },//gonderici grubu=6
                dataType: 'json',
                success: function (data) {
                    $('#' + id).empty();
                    $('#' + id).append($('<option>', {
                        value: "", // Verinin değer özelliği
                        text: "Seçiniz", // Verinin görünen metni
                        disabled: true,
                        selected: true,
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#' + id).append($('<option>', {
                            value: item.cari_ID, // Verinin değer özelliği
                            text: item.cari_Unvan // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }
        AliciCariListe('AliciCari_ID1');



        function TasinacakUrunListe(id) {
            $.ajax({
                url: '../../Ajax/TasinacakUrunListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                dataType: 'json',
                success: function (data) {
                    $('#' + id).empty();
                    $('#' + id).append($('<option>', {
                        value: "", // Verinin değer özelliği
                        text: "Seçiniz", // Verinin görünen metni
                        disabled: true,
                        selected: true,
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#' + id).append($('<option>', {
                            value: item.id, // Verinin değer özelliği
                            text: item.adi // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });
        }
        TasinacakUrunListe('TasinacakUrun_ID1_1');





        function UnListe(id) {
            $.ajax({
                url: '../../Ajax/UnListe', // Verileri sağlayan API'nin endpoint'i
                method: 'GET',
                dataType: 'json',
                success: function (data) {
                    $('#' + id).empty();
                    $('#' + id).append($('<option>', {
                        value: "", // Verinin değer özelliği
                        text: "Seçiniz", // Verinin görünen metni
                        disabled: true,
                        selected: true,
                    }));
                    // Verileri selectbox'a ekle
                    $.each(data, function (index, item) {
                        console.log(item);
                        $('#' + id).append($('<option>', {
                            value: item.un_ID, // Verinin değer özelliği
                            text: item.un_No + " - " + item.un_Isim // Verinin görünen metni
                        }));
                    });
                },
                error: function (error) {
                    console.log('Hata oluştu:', error);
                }
            });

        }
       // UnListe('Un_ID1_1');




        function kaydetEkle() {
            items++;

            document.getElementById("KayitSayisi").value = items;
            satirVeUrunSayisi.push({ satir: items, urun: 1 });
            // Create a new accordion item
            var accordionItem = document.createElement('div');
            accordionItem.className = 'accordion-item';

            // Create the accordion header
            var header = document.createElement('h2');
            header.className = 'accordion-header';
            header.id = 'heading' + items;

            // Create the button for collapsing/expanding
            var button = document.createElement('button');
            button.className = 'accordion-button collapsed';
            button.type = 'button';
            button.setAttribute('data-bs-toggle', 'collapse');
            button.setAttribute('data-bs-target', '#collapse' + items);
            button.setAttribute('aria-expanded', 'false');
            button.setAttribute('aria-controls', 'collapse' + items);
            button.innerText = items + '.KAYIT';

            // Append button to the header
            header.appendChild(button);

            // Create the accordion body
            var body = document.createElement('div');
            body.className = 'accordion-collapse collapse';
            body.id = 'collapse' + items;
            body.setAttribute('aria-labelledby', 'heading' + items);
            body.setAttribute('data-bs-parent', '#accordionExample');

            // Create the content of the accordion body
            var bodyContent = document.createElement('div');
            bodyContent.className = 'accordion-body pt-0';

            bodyContent.innerHTML = '<table class="table table-borderless" id="kayit' + items + '"> <!--Garanti--> <tr><td rowspan="4" colspan = "1" style = "width:50px !important; margin-right:10px;background:#0a4ea5" class="vertical-text text-center" > <h5 style="color:#fff !important;" > Gönderici Firma </h5 > </td > <td>Mal Sahibi </td > <td class="d-flex"><a href="../Cari/Ekle" target = "_blank" class="me-2" ><span class="text-body fs-5" data-feather="plus" > </span></a><a onclick = "GondericiCariListe(\'GondericiCari_ID' + items + '\')" class="me-2" style = "cursor:pointer;" ><span class="text-body fs-5" data-feather="refresh-ccw" > </span></a><select name="GondericiCari_ID' + items + '[]" class="form-control" id = "GondericiCari_ID' + items + '" > <option value="0" > Seçiniz </option ></select > </td ><td> Taşıma Türü </td><td class="d-flex" <a asp-controller="YurtDisiTasimaTipi" asp-action="Index" target = "_blank" class="me-2" ><span class="text-body fs-5" data-feather="plus" ></span></a><a onclick = "YurtDisiTasimaTipiListe(\'YurtDisiTasimaTipi_ID' + items + '\') " class="me-2" style = "cursor: pointer; " ><span class="text-body fs-5" data-feather="refresh-ccw" > </span></a><select name = "YurtDisiTasimaTipi_ID' + items + '[]" class=" form-control" id = "YurtDisiTasimaTipi_ID' + items + '" ><option value="0" > Seçiniz </option></select></td><td> Gümrükleme Tarihi </td><td> <input type="date" class="form-control" name = "GumruklemeTarihi' + items + '[]" id = "GumruklemeTarihi' + items + '" /> </td></tr><tr><td> Mal Yükleme Ülke </td><td><input type="text" class="form-control" name = "GondericiYuklemeUlke' + items + '[]" id = "GondericiYuklemeUlke' + items + '" /></td><td>Mal Yükleme İl</td><td><input type="text" class="form-control" name = "GondericiYuklemeIl' + items + '[]" id = "GondericiYuklemeIl' + items + '" /></td><td>Mal Yükleme İlçe</td><td><input type="text" class="form-control" name = "GondericiYuklemeIlce' + items + '[]" id = "GondericiYuklemeIlce' + items + '" /> </td></tr > <tr><td>Açık Adres</td><td colspan="5"><textarea class="form-control" name="GondericiYuklemeAcikAdres' + items + '[]" id = "GondericiYuklemeAcikAdres' + items + '"></textarea></td></tr><tr><td>Mal Yükleme Tarih Saat </td > <td colspan="5" > <input type="date" class="form-control" name = "GondericiFirmaTarihSaat' + items + '[]" id = "GondericiFirmaTarihSaat' + items + '" / > </td></tr ><tr><td rowspan="4" colspan = "1" style = "width:50px !important; margin-right:10px;background:#0e65d5" class="vertical-text text-center" > <h5 style="color:#fff !important;" > Alıcı Firma </h5></td > <td>Alıcı Firma </td><td class="d-flex"><a href="../Cari/Ekle" target = "_blank" class="me-2" ><span class="text-body fs-5" data-feather="plus" > </span></a><a onclick = "AliciCariListe(\'AliciCari_ID' + items + '\')" class="me-2" style = "cursor:pointer;" ><span class="text-body fs-5" data-feather="refresh-ccw" > </span></a><select name="AliciCari_ID' + items + '[]" class="form-control" id="AliciCari_ID' + items + '"><option value="0">Seçiniz</option > </select > </td ></tr><tr><td>İndirilen Ülke</td><td><input type="text" class= "form-control" name = "AliciIndirilenUlke' + items + '[]" id = "AliciIndirilenUlke' + items + '" /> </td><td>İndirilen İl</td><td><input type="text" class= "form-control" name = "AliciIndirilenIl' + items + '[]" id = "AliciIndirilenIl' + items + '" /> </td><td>İndirilen İlçe </td><td><input type="text" class= "form-control" name = "AliciIndirilenIlce' + items + '[]" id = "AliciIndirilenIlce' + items + '" /> </td></tr><tr><td>Açık Adres</td><td colspan="5"><textarea class="form-control" name="AliciIndirilenAcikAdres' + items + '[]" id="AliciIndirilenAcikAdres' + items + '"></textarea></td></tr><tr style="border-bottom: 1px solid #ddd; margin-bottom:2%;"><td>Alıcı Tarih Saat</td > <td colspan="5" > <input type="date" class= "form-control" name = "AliciFirmaTarihSaat' + items + '[]" id = "AliciFirmaTarihSaat' + items + '" /> </td></tr > <tr id = "templateRow' + items + '_1" > <td rowspan="2" colspan = "1" style = "width:50px !important; margin-right:10px;background:#06326b" class= "vertical-text text-center" > <h5 style="color:#fff !important;" > Ürün </h5></td > <td>Ürün Seç </td><td class="d-flex"><a href="../TasinacakUrun" target = "_blank" class="me-2" ><span class="text-body fs-5" data-feather="plus" > </span></a><a onclick = "TasinacakUrunListe(\'TasinacakUrun_ID' + items + '_1\')" class="me-2" style = "cursor:pointer;" ><span class="text-body fs-5" data-feather="refresh-ccw" > </span></a><select name="TasinacakUrun_ID' + items + '[]" class=" form-control" id = "TasinacakUrun_ID' + items + '_1"  ><option value="0" > Seçiniz </option ></select></td > <td>Yükleme Miktarı </td > <td><input type="number" class="form-control" name = "YuklemeMiktari' + items + '[]" onchange = "fiyatHesapla(' + items + ');" id = "YuklemeMiktari' + items + '_1" onblur="toplamYuk()"/ > </td></tr > <tr style = "border-bottom: 1px solid #ddd; margin-bottom:2%;" id = "templateRow' + items + '_2" > <td>Ödeme Yapan Cari </td><td><select name="Cari_Odeme_Yapan' + items + '[]" class=" form-control" id = "Cari_Odeme_Yapan_' + items + '_1" onchange="OdemeYapan(this)" ><option value="0" > Seçiniz </option > @foreach (var item in ViewBag.CariOdemeYapan)
        {
            <option value="@item.OdemeYapan_ID" > @item.OdemeYapan_Adi</option>
        }</select > <input type="hidden" name = "Cari_Odeme_YapanID' + items + '[]" class="form-control" id = "Cari_Odeme_Yapan_ID_' + items + '_1" > </td > <td>Ücretlendirme </td > <td><select name="Ucretlendirme_ID' + items + '[]" class=" form-control" id = "Ucretlendirme_ID' + items + '_1" onchange = "fiyatHesapla(' + items + ')" > <option value="0" > Seçiniz </option > @foreach (var item in ViewBag.Ucretlendirme)
        {
            <option value="@item.Ucretlendirme_ID" > @item.Ucretlendirme_Adi</option >
        }</select></td > <td>Birim veya Sefer Fiyatı </td><td> <input type="number" class="form-control" name = "Birim_SeferFiyat' + items + '[]" id = "Birim_SeferFiyat' + items + '_1" onchange="fiyatHesapla(' + items + ')" / > </td></tr > <tr id = "urunEkleTR' + items + '" > <td colspan="6" > <a class="btn btn-info col-3" onclick = "urunEkle(' + items + ')" > Ürün Ekle </a></td > </tr></table > <table class="table table-bordless" > <tr><td colspan="1" rowspan="2" style = "width:50px !important; margin-right:10px;background:#589cf3" class="vertical-text text-center" > <h5 style="color:#fff !important;" > Nakliye Bedeli </h5></td > <td>Tutar(KDV Hariç) </td><td><input type="number" class="form-control" name="NakliyeBedelTutar_KDVsiz' + items + '[]" id="NakliyeBedelTutar_KDVsiz' + items + '"/ > </td><td>Kdv</td > <td><input type="number" class="form-control" name = "NakliyeBedelTutar_KDV' + items + '[]" id = "NakliyeBedelTutar_KDV' + items + '" /> </td><td>Toplam</td > <td><input type="text" class="form-control" name = "NakliyeBedeliToplam_KDVli' + items + '[]" id = "NakliyeBedeliToplam_KDVli' + items + '" /> </td></tr > <tr><td>Fiyat </td><td colspan="5"><input type="text" class="form-control" name="Fiyat' + items + '[]" id="Fiyat' + items + '" readonly></td > </tr> </table > ';

            // Append content to the accordion body
            body.appendChild(bodyContent);

            // Append header and body to the accordion item
            accordionItem.appendChild(header);
            accordionItem.appendChild(body);

            // Append the new accordion item to the accordion container
            var accordionContainer = document.getElementById('accordionExample');
            accordionContainer.appendChild(accordionItem);
            GondericiCariListe('GondericiCari_ID' + items);
            AliciCariListe('AliciCari_ID' + items);
            TasinacakUrunListe('TasinacakUrun_ID' + items + '_1');
            YurtDisiTasimaTipiListe('YurtDisiTasimaTipi_ID' + items);
            //UnListe('Un_ID' + items + '_1');
            feather.replace();
        }

      
        function urunEkle(sira) {
            debugger;
            var bulunanElemanIndex = satirVeUrunSayisi.findIndex(function (eleman) {
                return eleman.satir === sira;
            });

            var urunsayisi = satirVeUrunSayisi[bulunanElemanIndex].urun;

            // Urun değerini artır
            urunsayisi += 1;

            // Urun değerini güncelle
            satirVeUrunSayisi[bulunanElemanIndex].urun = urunsayisi;


            var table = document.getElementById("kayit" + sira);

            // Clone the template rows
            var clonedRow1 = document.getElementById("templateRow" + sira + "_1").cloneNode(true);
            var clonedRow2 = document.getElementById("templateRow" + sira + "_2").cloneNode(true);

            // Update the IDs of the cloned rows
            updateIds(clonedRow1, urunsayisi);
            updateIds(clonedRow2, urunsayisi);
            // Add a class to cloned rows for styling
            clonedRow1.classList.add("cloned-row");
            clonedRow2.classList.add("cloned-row");

            // Find the "Ürün Ekle" button's parent row
            var buttonRow = document.querySelector('#kayit' + sira + ' tr:last-child');

            // Insert the cloned rows before the button row
            buttonRow.parentNode.insertBefore(clonedRow1, buttonRow);
            buttonRow.parentNode.insertBefore(clonedRow2, buttonRow);
        }

        function updateIds(row, index) {
            // Update the ID of the cloned rows
            var newRowId = index;
            row.id = "row" + newRowId;

            // Update the IDs of all input fields within the cloned rows
            var inputs = row.querySelectorAll('input, select');
            inputs.forEach(function (input) {
                var oldId = input.id;
                if (oldId) {
                    input.id = oldId.replace(/\d+$/, newRowId);
                }


                var oldName = input.name;
                if (oldName) {
                    input.name = oldName.replace(/\d+$/, newRowId);
                }
                // Check if it's an input element
                if (input.tagName.toLowerCase() === 'input') {
                    input.value = ''; // Clear the input value
                }

                // Check if it's a select element
                if (input.tagName.toLowerCase() === 'select') {
                    input.value = '0'; // Assuming the default value is '0', change it accordingly
                }

            });
            var links = row.querySelectorAll('a');
            links.forEach(function (link) {
                var onclickAttr = link.getAttribute('onclick');
                if (onclickAttr) {
                    var newOnclickAttr = onclickAttr.replace(/\d+$/, newRowId);
                    link.setAttribute('onclick', newOnclickAttr);
                }
            });

            var selects = row.querySelectorAll('select');
            selects.forEach(function (select) {
                var relatedLink = select.closest('td').querySelector('a[onclick]');
                if (relatedLink) {
                    var newId = select.id.replace(/\d+$/, newRowId);
                    var newOnclickAttr = relatedLink.getAttribute('onclick').replace(/'\w+_\d+'/g, `'${newId}'`);
                    relatedLink.setAttribute('onclick', newOnclickAttr);
                }
            });
        }
        function EvrakSatiriEkle() {
            // hiddenFields4 satırını klonlayın
            var table = document.getElementById("hiddenFields4");

            // Yeni bir satır ekle
            var newRow = table.insertRow();

            // Yeni satıra hücreler ekle ve içeriği kopyala
            var cell0 = newRow.insertCell(0);
            var cell1 = newRow.insertCell(1);
            var cell2 = newRow.insertCell(2);
            var cell3 = newRow.insertCell(3);
            var cell4 = newRow.insertCell(4);
            var cell5 = newRow.insertCell(5);
            var cell6 = newRow.insertCell(6);
            var sira = table.getElementsByTagName('tr').length + 1;


            // İçeriği doldur
            cell0.innerHTML = `<a onclick='EvrakSatirSil("TREvraklar` + sira + `ID") '>
                                    <span class="text-body fs-5" data-feather="x" style = "color:red;"  width="16px" height="16px"> </span>
                                </a>`;
            cell1.innerHTML = 'Evrak';
            cell2.innerHTML = `<div class="d-flex align-items-center">
                                                 <a href="/YurtDisiEvraklar/Index" target="_blank" class="me-2">
                                                            <span class="text-body fs-5" data-feather="plus" width="16px" height="16px"></span>
                                                </a>
                                                                <a onclick="YurtDisiEvraklarListe(`+ sira + `)" class="me-2" style="cursor:pointer;">
                                                            <span class="text-body fs-5" data-feather="refresh-ccw" width="16px" height="16px"></span>
                                                </a>
                                                                                <select class="form-control" name="Evraklar[]" id="Evraklar`+ sira + `ID" style="width:100%">
                                    <option value="" disabled selected>Seçiniz</option>
                                </select></div>
                            `;
            cell3.innerHTML = 'Veriliş Tarihi';
            cell4.innerHTML = '<input type="date" class="form-control" name="EvraklarVerilisTarihi[]" />';
            cell5.innerHTML = 'Geçerlilik Tarihi';
            cell6.innerHTML = '<input type="date" class="form-control" name="EvraklarGecerlilikTarihi[]" />';
            YurtDisiEvraklarListe(sira);

            feather.replace();

            $('#Evraklar' + sira + 'ID').select2();
        }
        function EvrakSatirSil(satirID) {
            var satir = document.getElementById(satirID);

            // Satırı sil
            if (satir) {
                satir.parentNode.removeChild(satir);
                console.log("Satır başarıyla silindi.");
            } else {
                console.error("Belirtilen satır bulunamadı.");
            }
        }

    </script>
}